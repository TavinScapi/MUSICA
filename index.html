<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal do M√∫sico</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>

<body>
    <header class="header">
        <div class="logo">
            <h1>Portal do M√∫sico</h1>
        </div>
        <nav class="navbar">
            <ul>
                <li><a href="#">In√≠cio</a></li>
                <li><a href="#">Aulas</a></li>
                <li><a href="#">Cifras</a></li>
            </ul>
        </nav>
        <div class="theme-toggle">
            <button onclick="toggleTheme()">üåô</button>
        </div>
    </header>

    <main class="main-content">
        <div class="hero">
            <h2>Explore Ferramentas Musicais</h2>
            <p>Encontre recursos como metr√¥nomo, afinador e muito mais!</p>
            <div class="buttons">
                <button onclick="openMetronome()">Metr√¥nomo</button>
                <button onclick="openTuner()">Afinador de Viol√£o</button>
                <button onclick="openRecorder()">Gravador</button>
            </div>
        </div>

        <section class="top-music">
            <h2>M√∫sicas Mais Tocadas no Momento</h2>
            <div class="music-list">
                <!-- As m√∫sicas ser√£o adicionadas aqui dinamicamente -->
            </div>
        </section>
        
    </main>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2024 Portal do M√∫sico | Todos os direitos reservados</p>
        </div>
    </footer>

    <script>
        // Fun√ß√£o para pegar o token de acesso
        async function getAccessToken() {
            const clientId = '1ca02f4c12f247de9ef1552f920e191e'; // Substitua pelo seu Client ID
            const clientSecret = 'fab35dd8d9d044f281c89d264c65e20f'; // Substitua pelo seu Client Secret
            const authHeader = 'Basic ' + btoa(clientId + ':' + clientSecret);

            const response = await fetch('https://accounts.spotify.com/api/token', {
                method: 'POST',
                headers: {
                    'Authorization': authHeader,
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'grant_type=client_credentials',
            });
            const data = await response.json();
            return data.access_token;
        }

        // Fun√ß√£o para pegar as m√∫sicas mais tocadas
        async function fetchTopTracks() {
            const token = await getAccessToken();
            if (!token) {
                alert('N√£o foi poss√≠vel obter o token de acesso.');
                return;
            }

            const response = await fetch('https://api.spotify.com/v1/me/top/tracks', {  // Mudado para pegar as m√∫sicas mais tocadas
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`,
                },
            });

            const data = await response.json();
            return data.items; // Lista de m√∫sicas mais tocadas
        }

        // Fun√ß√£o para exibir as m√∫sicas no HTML
        async function displayTopTracks() {
            const topTracks = await fetchTopTracks();
            const musicList = document.querySelector('.music-list'); // Assume que voc√™ tem uma classe .music-list no seu HTML

            if (!topTracks || topTracks.length === 0) {
                musicList.innerHTML = '<p>N√£o foi poss√≠vel carregar as m√∫sicas.</p>';
                return;
            }

            topTracks.forEach(track => {
                const musicItem = document.createElement('div');
                musicItem.classList.add('music-item');

                musicItem.innerHTML = `
                    <h3>${track.name}</h3>
                    <p>Artista: ${track.artists[0].name}</p>
                    <button onclick="playSample('${track.preview_url}')">Ouvir amostra</button>
                `;

                musicList.appendChild(musicItem);
            });
        }

        // Fun√ß√£o para tocar amostra
        function playSample(previewUrl) {
            if (previewUrl) {
                const audio = new Audio(previewUrl);
                audio.play();
            } else {
                alert('Amostra n√£o dispon√≠vel.');
            }
        }

        displayTopTracks();  // Chama a fun√ß√£o para exibir as m√∫sicas
    </script>

</body>

</html>
